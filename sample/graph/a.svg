<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: brt_model Pages: 1 -->
<svg width="578pt" height="1008pt"
 viewBox="0.00 0.00 577.50 1008.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1004)">
<title>brt_model</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1004 573.5,-1004 573.5,4 -4,4"/>
<!-- x -->
<g id="node1" class="node">
<title>x</title>
<path fill="AliceBlue" stroke="black" d="M121,-907.5C121,-907.5 266,-907.5 266,-907.5 272,-907.5 278,-913.5 278,-919.5 278,-919.5 278,-987.5 278,-987.5 278,-993.5 272,-999.5 266,-999.5 266,-999.5 121,-999.5 121,-999.5 115,-999.5 109,-993.5 109,-987.5 109,-987.5 109,-919.5 109,-919.5 109,-913.5 115,-907.5 121,-907.5"/>
<text text-anchor="middle" x="193.5" y="-984.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%x</text>
<polyline fill="none" stroke="black" points="109,-976.5 278,-976.5 "/>
<text text-anchor="middle" x="193.5" y="-961.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=placeholder</text>
<polyline fill="none" stroke="black" points="109,-953.5 278,-953.5 "/>
<text text-anchor="middle" x="193.5" y="-938.3" font-family="Times,serif" font-size="14.00" fill="#000000">target=x</text>
<polyline fill="none" stroke="black" points="109,-930.5 278,-930.5 "/>
<text text-anchor="middle" x="193.5" y="-915.3" font-family="Times,serif" font-size="14.00" fill="#000000">num_users=2</text>
</g>
<!-- rand_gate -->
<g id="node2" class="node">
<title>rand_gate</title>
<path fill="#c1ffc1" stroke="black" d="M12,-725.5C12,-725.5 227,-725.5 227,-725.5 233,-725.5 239,-731.5 239,-737.5 239,-737.5 239,-858.5 239,-858.5 239,-864.5 233,-870.5 227,-870.5 227,-870.5 12,-870.5 12,-870.5 6,-870.5 0,-864.5 0,-858.5 0,-858.5 0,-737.5 0,-737.5 0,-731.5 6,-725.5 12,-725.5"/>
<text text-anchor="middle" x="119.5" y="-855.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%rand_gate</text>
<polyline fill="none" stroke="black" points="0,-847.5 239,-847.5 "/>
<text text-anchor="middle" x="119.5" y="-832.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_function</text>
<polyline fill="none" stroke="black" points="0,-824.5 239,-824.5 "/>
<text text-anchor="middle" x="119.5" y="-809.3" font-family="Times,serif" font-size="14.00" fill="#000000">target=brt.app.rand.rand_gate</text>
<polyline fill="none" stroke="black" points="0,-801.5 239,-801.5 "/>
<text text-anchor="start" x="8" y="-786.3" font-family="Times,serif" font-size="14.00" fill="#000000">args=(</text>
<text text-anchor="middle" x="119.5" y="-771.3" font-family="Times,serif" font-size="14.00" fill="#000000">2,</text>
<text text-anchor="start" x="8" y="-756.3" font-family="Times,serif" font-size="14.00" fill="#000000">)</text>
<polyline fill="none" stroke="black" points="0,-748.5 239,-748.5 "/>
<text text-anchor="middle" x="119.5" y="-733.3" font-family="Times,serif" font-size="14.00" fill="#000000">num_users=1</text>
</g>
<!-- x&#45;&gt;rand_gate -->
<g id="edge3" class="edge">
<title>x&#45;&gt;rand_gate</title>
<path fill="none" stroke="black" d="M171.7,-907.28C167.5,-898.56 162.98,-889.19 158.43,-879.75"/>
<polygon fill="black" stroke="black" points="161.55,-878.17 154.06,-870.68 155.25,-881.21 161.55,-878.17"/>
</g>
<!-- rand_scatter_scatter_router -->
<g id="node3" class="node">
<title>rand_scatter_scatter_router</title>
<path fill="#fffacd" stroke="black" d="M185.5,-587.5C185.5,-587.5 441.5,-587.5 441.5,-587.5 447.5,-587.5 453.5,-593.5 453.5,-599.5 453.5,-599.5 453.5,-676.5 453.5,-676.5 453.5,-682.5 447.5,-688.5 441.5,-688.5 441.5,-688.5 185.5,-688.5 185.5,-688.5 179.5,-688.5 173.5,-682.5 173.5,-676.5 173.5,-676.5 173.5,-599.5 173.5,-599.5 173.5,-593.5 179.5,-587.5 185.5,-587.5"/>
<text text-anchor="middle" x="313.5" y="-673.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%rand_scatter_scatter_router</text>
<polyline fill="none" stroke="black" points="173.5,-665.5 453.5,-665.5 "/>
<text text-anchor="middle" x="313.5" y="-650.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_module</text>
<text text-anchor="middle" x="313.5" y="-619.3" font-family="Times,serif" font-size="14.00" fill="#000000">brt.router.generic.ScatterRouter</text>
<polyline fill="none" stroke="black" points="173.5,-611.5 453.5,-611.5 "/>
</g>
<!-- x&#45;&gt;rand_scatter_scatter_router -->
<g id="edge4" class="edge">
<title>x&#45;&gt;rand_scatter_scatter_router</title>
<path fill="none" stroke="black" d="M227.07,-907.46C234.56,-895.98 241.92,-883.38 247.5,-871 275.08,-809.76 267.77,-789.5 286.5,-725 288.97,-716.48 291.67,-707.52 294.38,-698.73"/>
<polygon fill="black" stroke="black" points="297.81,-699.5 297.43,-688.91 291.12,-697.43 297.81,-699.5"/>
</g>
<!-- rand_gate&#45;&gt;rand_scatter_scatter_router -->
<g id="edge5" class="edge">
<title>rand_gate&#45;&gt;rand_scatter_scatter_router</title>
<path fill="none" stroke="black" d="M207.42,-725.4C219.92,-715.22 232.62,-704.87 244.69,-695.04"/>
<polygon fill="black" stroke="black" points="246.97,-697.7 252.52,-688.67 242.55,-692.27 246.97,-697.7"/>
</g>
<!-- getitem -->
<g id="node6" class="node">
<title>getitem</title>
<path fill="#fff0f5" stroke="black" d="M116.5,-405.5C116.5,-405.5 292.5,-405.5 292.5,-405.5 298.5,-405.5 304.5,-411.5 304.5,-417.5 304.5,-417.5 304.5,-538.5 304.5,-538.5 304.5,-544.5 298.5,-550.5 292.5,-550.5 292.5,-550.5 116.5,-550.5 116.5,-550.5 110.5,-550.5 104.5,-544.5 104.5,-538.5 104.5,-538.5 104.5,-417.5 104.5,-417.5 104.5,-411.5 110.5,-405.5 116.5,-405.5"/>
<text text-anchor="middle" x="204.5" y="-535.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%getitem</text>
<polyline fill="none" stroke="black" points="104.5,-527.5 304.5,-527.5 "/>
<text text-anchor="middle" x="204.5" y="-512.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_function</text>
<polyline fill="none" stroke="black" points="104.5,-504.5 304.5,-504.5 "/>
<text text-anchor="middle" x="204.5" y="-489.3" font-family="Times,serif" font-size="14.00" fill="#000000">target=_operator.getitem</text>
<polyline fill="none" stroke="black" points="104.5,-481.5 304.5,-481.5 "/>
<text text-anchor="start" x="112.5" y="-466.3" font-family="Times,serif" font-size="14.00" fill="#000000">args=(</text>
<text text-anchor="middle" x="204.5" y="-451.3" font-family="Times,serif" font-size="14.00" fill="#000000">0,</text>
<text text-anchor="start" x="112.5" y="-436.3" font-family="Times,serif" font-size="14.00" fill="#000000">)</text>
<polyline fill="none" stroke="black" points="104.5,-428.5 304.5,-428.5 "/>
<text text-anchor="middle" x="204.5" y="-413.3" font-family="Times,serif" font-size="14.00" fill="#000000">num_users=1</text>
</g>
<!-- rand_scatter_scatter_router&#45;&gt;getitem -->
<g id="edge6" class="edge">
<title>rand_scatter_scatter_router&#45;&gt;getitem</title>
<path fill="none" stroke="black" d="M279.31,-587.44C273.08,-578.41 266.44,-568.78 259.78,-559.13"/>
<polygon fill="black" stroke="black" points="262.5,-556.9 253.94,-550.66 256.73,-560.88 262.5,-556.9"/>
</g>
<!-- getitem_1 -->
<g id="node8" class="node">
<title>getitem_1</title>
<path fill="#fff0f5" stroke="black" d="M345.5,-405.5C345.5,-405.5 521.5,-405.5 521.5,-405.5 527.5,-405.5 533.5,-411.5 533.5,-417.5 533.5,-417.5 533.5,-538.5 533.5,-538.5 533.5,-544.5 527.5,-550.5 521.5,-550.5 521.5,-550.5 345.5,-550.5 345.5,-550.5 339.5,-550.5 333.5,-544.5 333.5,-538.5 333.5,-538.5 333.5,-417.5 333.5,-417.5 333.5,-411.5 339.5,-405.5 345.5,-405.5"/>
<text text-anchor="middle" x="433.5" y="-535.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%getitem_1</text>
<polyline fill="none" stroke="black" points="333.5,-527.5 533.5,-527.5 "/>
<text text-anchor="middle" x="433.5" y="-512.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_function</text>
<polyline fill="none" stroke="black" points="333.5,-504.5 533.5,-504.5 "/>
<text text-anchor="middle" x="433.5" y="-489.3" font-family="Times,serif" font-size="14.00" fill="#000000">target=_operator.getitem</text>
<polyline fill="none" stroke="black" points="333.5,-481.5 533.5,-481.5 "/>
<text text-anchor="start" x="341.5" y="-466.3" font-family="Times,serif" font-size="14.00" fill="#000000">args=(</text>
<text text-anchor="middle" x="433.5" y="-451.3" font-family="Times,serif" font-size="14.00" fill="#000000">1,</text>
<text text-anchor="start" x="341.5" y="-436.3" font-family="Times,serif" font-size="14.00" fill="#000000">)</text>
<polyline fill="none" stroke="black" points="333.5,-428.5 533.5,-428.5 "/>
<text text-anchor="middle" x="433.5" y="-413.3" font-family="Times,serif" font-size="14.00" fill="#000000">num_users=1</text>
</g>
<!-- rand_scatter_scatter_router&#45;&gt;getitem_1 -->
<g id="edge7" class="edge">
<title>rand_scatter_scatter_router&#45;&gt;getitem_1</title>
<path fill="none" stroke="black" d="M351.14,-587.44C358.07,-578.32 365.46,-568.59 372.86,-558.84"/>
<polygon fill="black" stroke="black" points="375.81,-560.74 379.07,-550.66 370.24,-556.51 375.81,-560.74"/>
</g>
<!-- rand_scatter_scatter_router.load_history -->
<g id="node4" class="node">
<title>rand_scatter_scatter_router.load_history</title>
<path fill="Salmon" stroke="black" d="M307.5,-779C307.5,-779 411.5,-779 411.5,-779 417.5,-779 423.5,-785 423.5,-791 423.5,-791 423.5,-805 423.5,-805 423.5,-811 417.5,-817 411.5,-817 411.5,-817 307.5,-817 307.5,-817 301.5,-817 295.5,-811 295.5,-805 295.5,-805 295.5,-791 295.5,-791 295.5,-785 301.5,-779 307.5,-779"/>
<text text-anchor="start" x="303.5" y="-801.8" font-family="Times,serif" font-size="14.00" fill="#000000">buffer</text>
<text text-anchor="middle" x="359.5" y="-786.8" font-family="Times,serif" font-size="14.00" fill="#000000">torch.float32[2]</text>
</g>
<!-- rand_scatter_scatter_router.load_history&#45;&gt;rand_scatter_scatter_router -->
<g id="edge1" class="edge">
<title>rand_scatter_scatter_router.load_history&#45;&gt;rand_scatter_scatter_router</title>
<path fill="none" stroke="black" d="M354.22,-778.88C348.52,-759.3 339.14,-727.07 330.81,-698.47"/>
<polygon fill="black" stroke="black" points="334.08,-697.16 327.92,-688.54 327.36,-699.12 334.08,-697.16"/>
</g>
<!-- rand_scatter_scatter_router.capacity_history -->
<g id="node5" class="node">
<title>rand_scatter_scatter_router.capacity_history</title>
<path fill="Salmon" stroke="black" d="M453.5,-779C453.5,-779 557.5,-779 557.5,-779 563.5,-779 569.5,-785 569.5,-791 569.5,-791 569.5,-805 569.5,-805 569.5,-811 563.5,-817 557.5,-817 557.5,-817 453.5,-817 453.5,-817 447.5,-817 441.5,-811 441.5,-805 441.5,-805 441.5,-791 441.5,-791 441.5,-785 447.5,-779 453.5,-779"/>
<text text-anchor="start" x="449.5" y="-801.8" font-family="Times,serif" font-size="14.00" fill="#000000">buffer</text>
<text text-anchor="middle" x="505.5" y="-786.8" font-family="Times,serif" font-size="14.00" fill="#000000">torch.float32[2]</text>
</g>
<!-- rand_scatter_scatter_router.capacity_history&#45;&gt;rand_scatter_scatter_router -->
<g id="edge2" class="edge">
<title>rand_scatter_scatter_router.capacity_history&#45;&gt;rand_scatter_scatter_router</title>
<path fill="none" stroke="black" d="M488.51,-778.76C474.16,-763.71 452.75,-742.13 432.5,-725 420.41,-714.77 407.19,-704.45 394.08,-694.67"/>
<polygon fill="black" stroke="black" points="396.08,-691.79 385.95,-688.66 391.92,-697.42 396.08,-691.79"/>
</g>
<!-- expert1 -->
<g id="node7" class="node">
<title>expert1</title>
<path fill="#fffacd" stroke="black" d="M70.5,-267.5C70.5,-267.5 292.5,-267.5 292.5,-267.5 298.5,-267.5 304.5,-273.5 304.5,-279.5 304.5,-279.5 304.5,-356.5 304.5,-356.5 304.5,-362.5 298.5,-368.5 292.5,-368.5 292.5,-368.5 70.5,-368.5 70.5,-368.5 64.5,-368.5 58.5,-362.5 58.5,-356.5 58.5,-356.5 58.5,-279.5 58.5,-279.5 58.5,-273.5 64.5,-267.5 70.5,-267.5"/>
<text text-anchor="middle" x="181.5" y="-353.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%expert1</text>
<polyline fill="none" stroke="black" points="58.5,-345.5 304.5,-345.5 "/>
<text text-anchor="middle" x="181.5" y="-330.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_module</text>
<text text-anchor="middle" x="181.5" y="-299.3" font-family="Times,serif" font-size="14.00" fill="#000000">torch.nn.modules.linear.Identity</text>
<polyline fill="none" stroke="black" points="58.5,-291.5 304.5,-291.5 "/>
</g>
<!-- getitem&#45;&gt;expert1 -->
<g id="edge8" class="edge">
<title>getitem&#45;&gt;expert1</title>
<path fill="none" stroke="black" d="M194.08,-405.4C192.78,-396.48 191.46,-387.43 190.19,-378.72"/>
<polygon fill="black" stroke="black" points="193.63,-378.06 188.73,-368.67 186.71,-379.07 193.63,-378.06"/>
</g>
<!-- gather_router -->
<g id="node10" class="node">
<title>gather_router</title>
<path fill="#fffacd" stroke="black" d="M202,-129.5C202,-129.5 425,-129.5 425,-129.5 431,-129.5 437,-135.5 437,-141.5 437,-141.5 437,-218.5 437,-218.5 437,-224.5 431,-230.5 425,-230.5 425,-230.5 202,-230.5 202,-230.5 196,-230.5 190,-224.5 190,-218.5 190,-218.5 190,-141.5 190,-141.5 190,-135.5 196,-129.5 202,-129.5"/>
<text text-anchor="middle" x="313.5" y="-215.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%gather_router</text>
<polyline fill="none" stroke="black" points="190,-207.5 437,-207.5 "/>
<text text-anchor="middle" x="313.5" y="-192.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_module</text>
<text text-anchor="middle" x="313.5" y="-161.3" font-family="Times,serif" font-size="14.00" fill="#000000">brt.router.generic.GatherRouter</text>
<polyline fill="none" stroke="black" points="190,-153.5 437,-153.5 "/>
</g>
<!-- expert1&#45;&gt;gather_router -->
<g id="edge9" class="edge">
<title>expert1&#45;&gt;gather_router</title>
<path fill="none" stroke="black" d="M229.9,-267.13C239.05,-257.71 248.68,-247.78 258.03,-238.15"/>
<polygon fill="black" stroke="black" points="260.65,-240.48 265.1,-230.86 255.63,-235.6 260.65,-240.48"/>
</g>
<!-- expert2 -->
<g id="node9" class="node">
<title>expert2</title>
<path fill="#fffacd" stroke="black" d="M334.5,-267.5C334.5,-267.5 556.5,-267.5 556.5,-267.5 562.5,-267.5 568.5,-273.5 568.5,-279.5 568.5,-279.5 568.5,-356.5 568.5,-356.5 568.5,-362.5 562.5,-368.5 556.5,-368.5 556.5,-368.5 334.5,-368.5 334.5,-368.5 328.5,-368.5 322.5,-362.5 322.5,-356.5 322.5,-356.5 322.5,-279.5 322.5,-279.5 322.5,-273.5 328.5,-267.5 334.5,-267.5"/>
<text text-anchor="middle" x="445.5" y="-353.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%expert2</text>
<polyline fill="none" stroke="black" points="322.5,-345.5 568.5,-345.5 "/>
<text text-anchor="middle" x="445.5" y="-330.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=call_module</text>
<text text-anchor="middle" x="445.5" y="-299.3" font-family="Times,serif" font-size="14.00" fill="#000000">torch.nn.modules.linear.Identity</text>
<polyline fill="none" stroke="black" points="322.5,-291.5 568.5,-291.5 "/>
</g>
<!-- getitem_1&#45;&gt;expert2 -->
<g id="edge10" class="edge">
<title>getitem_1&#45;&gt;expert2</title>
<path fill="none" stroke="black" d="M438.94,-405.4C439.62,-396.48 440.3,-387.43 440.96,-378.72"/>
<polygon fill="black" stroke="black" points="444.46,-378.9 441.73,-368.67 437.48,-378.37 444.46,-378.9"/>
</g>
<!-- expert2&#45;&gt;gather_router -->
<g id="edge11" class="edge">
<title>expert2&#45;&gt;gather_router</title>
<path fill="none" stroke="black" d="M397.1,-267.13C387.95,-257.71 378.32,-247.78 368.97,-238.15"/>
<polygon fill="black" stroke="black" points="371.37,-235.6 361.9,-230.86 366.35,-240.48 371.37,-235.6"/>
</g>
<!-- output -->
<g id="node11" class="node">
<title>output</title>
<path fill="PowderBlue" stroke="black" d="M259,-0.5C259,-0.5 368,-0.5 368,-0.5 374,-0.5 380,-6.5 380,-12.5 380,-12.5 380,-80.5 380,-80.5 380,-86.5 374,-92.5 368,-92.5 368,-92.5 259,-92.5 259,-92.5 253,-92.5 247,-86.5 247,-80.5 247,-80.5 247,-12.5 247,-12.5 247,-6.5 253,-0.5 259,-0.5"/>
<text text-anchor="middle" x="313.5" y="-77.3" font-family="Times,serif" font-size="14.00" fill="#000000">name=%output</text>
<polyline fill="none" stroke="black" points="247,-69.5 380,-69.5 "/>
<text text-anchor="middle" x="313.5" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#000000">op_code=output</text>
<polyline fill="none" stroke="black" points="247,-46.5 380,-46.5 "/>
<text text-anchor="middle" x="313.5" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#000000">target=output</text>
<polyline fill="none" stroke="black" points="247,-23.5 380,-23.5 "/>
<text text-anchor="middle" x="313.5" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#000000">num_users=0</text>
</g>
<!-- gather_router&#45;&gt;output -->
<g id="edge12" class="edge">
<title>gather_router&#45;&gt;output</title>
<path fill="none" stroke="black" d="M313.5,-129.29C313.5,-120.61 313.5,-111.53 313.5,-102.72"/>
<polygon fill="black" stroke="black" points="317,-102.53 313.5,-92.53 310,-102.53 317,-102.53"/>
</g>
</g>
</svg>
